# REST-API для предсказания наличие диабета у человека

REST-api (ну почти :)) использует WSGI-сервер Gunicorn для взаимодействия с приложением. WSGI-сервер предоставляет интерфейс, обеспечивающий преобразование клиентских запросов по протоколу HTTP в вызовы Python, исполняемые приложением.

## Данные

Данные для обучения модели взяты с https://www.kaggle.com/datasets/iammustafatz/diabetes-prediction-dataset

Файл __diabetes_prediction_dataset.csv__ (не содержится в репозитории) содержит медицинские и демографические данные пациентов, а также их диабетический статус, положительный или отрицательный. 

Файл состоит из различных характеристик, таких как возраст, пол, индекс массы тела (ИМТ), гипертония, болезни сердца, история курения, уровень HbA1c и уровень глюкозы в крови. 

Датасет содержит 100 000 записей и 9 полей с данными

## Модель

Для бинарной классификации выбрана модель: __RandomForestClassifier__ из пакета __sklearn.ensemble__

### Обучение

Обучение выбранной модели осуществлялось классическим способом: разделением набора данных на тренировочную и валидационную часть. В качестве метрики качества модели использовалались: f-score, roc_auc_score.

Для подбора гипер-параметров использовался GridSearchCV.

Код для очистки и преобразования данных, EDA, создания пайп-лайна, тренировки, подбора параметров, определения важности фичей, создания финальной модели находится в ноутбуке: __create_model.ipynb__

При обучении и валидации данных достигнута точность __97.7%__ (по roc_auc score).

При этом, порог вероятности для положительного класса составил: __0.853320012068987__

В результате обучения модели, был сделан вывод о том, что пол не влияет на наличие диабета. 

В сети найдены противоречивые данные: одни источники утверждают что женщины более подвержены диабету, другие - что мужчины. 

Данная работа не преследует цели доказать или подтвердить какую-то точку зрения и научные изыскания, тем более, что диабет бывает нескольких типов. 

При выполнении данной работы, получилось что пол не влияет на предсказание. На всякий случай, были проверены несколько различных классификаторов. Все они показали низкую важность признака пола.

Признак пола выкинут из финальной модели.

### Тестирование

Тестирование, сохраненной ранее, модели выполнено в ноутбуке: __test_saved_model.ipynb__

Также, в этом ноутбуке написан простой клиент для тестирования готового сервера.

### Front-end

Для для удобного тестирования приложения сделана специальная HTML-страница с формой для ввода параметров, которые потом отправляются на сервер для предсказания результата. На странице используется чистый javascript и простая разметка HTML (без загрузки дополнительных фреймворков). Запросы отправляются без перезагрузки страницы. Результат обработки или сообщения об ошибках из АПИ, отображаются там же.

## Контейнеризация

Для запуска приложения можно использовать докер-контейнер.
Для сборки контейнера написан соответствующий файл: __Dockerfile__

Выбрана простая модель: не используется дополнительный HTTP-сервер (nginx или apache). Gunicorn вполне достаточен для этого проекта. 

### Сборка контайнера

Сборка контейнера выполнялась командой: 
__docker build -t flask-api .__

### Запуск контейнера

Запускать готовый контейнер можно командой:
__docker run -p 5000:5000 flask-api -d__

